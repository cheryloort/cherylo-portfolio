<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Massa Spectrometrie - Opdracht vrije tijd | Portfolio</title>
  <meta name="description" content="4 Massa Spectrometrie - Opdracht vrije tijd | Portfolio" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Massa Spectrometrie - Opdracht vrije tijd | Portfolio" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Massa Spectrometrie - Opdracht vrije tijd | Portfolio" />
  
  
  

<meta name="author" content="Cheryl" />


<meta name="date" content="2024-11-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="opdracht-1.html"/>
<link rel="next" href="opdracht-3-guerrilla-analytics-framework.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introductie</a></li>
<li class="chapter" data-level="2" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html"><i class="fa fa-check"></i><b>2</b> Curriculum vitae</a>
<ul>
<li class="chapter" data-level="2.1" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#opleidingen"><i class="fa fa-check"></i><b>2.1</b> Opleidingen</a></li>
<li class="chapter" data-level="2.2" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#werkervaring"><i class="fa fa-check"></i><b>2.2</b> Werkervaring</a></li>
<li class="chapter" data-level="2.3" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#vaardigheden"><i class="fa fa-check"></i><b>2.3</b> Vaardigheden</a></li>
<li class="chapter" data-level="2.4" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#cursussen"><i class="fa fa-check"></i><b>2.4</b> Cursussen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="opdracht-1.html"><a href="opdracht-1.html"><i class="fa fa-check"></i><b>3</b> Opdracht 1.2</a></li>
<li class="chapter" data-level="4" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html"><i class="fa fa-check"></i><b>4</b> Massa Spectrometrie - Opdracht vrije tijd</a>
<ul>
<li class="chapter" data-level="4.1" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#introductie-1"><i class="fa fa-check"></i><b>4.1</b> Introductie</a></li>
<li class="chapter" data-level="4.2" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#planning"><i class="fa fa-check"></i><b>4.2</b> Planning</a></li>
<li class="chapter" data-level="4.3" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#uitvoering-met-voorbeeld-data"><i class="fa fa-check"></i><b>4.3</b> Uitvoering met voorbeeld data</a></li>
<li class="chapter" data-level="4.4" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#uitvoering-met-eigen-data"><i class="fa fa-check"></i><b>4.4</b> Uitvoering met eigen data</a></li>
<li class="chapter" data-level="4.5" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#metadata"><i class="fa fa-check"></i><b>4.5</b> Metadata</a></li>
<li class="chapter" data-level="4.6" data-path="massa-spectrometrie---opdracht-vrije-tijd.html"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#links"><i class="fa fa-check"></i><b>4.6</b> Links</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="opdracht-3-guerrilla-analytics-framework.html"><a href="opdracht-3-guerrilla-analytics-framework.html"><i class="fa fa-check"></i><b>5</b> Opdracht 3: Guerrilla Analytics framework</a>
<ul>
<li class="chapter" data-level="5.1" data-path="opdracht-3-guerrilla-analytics-framework.html"><a href="opdracht-3-guerrilla-analytics-framework.html#a"><i class="fa fa-check"></i><b>5.1</b> A</a></li>
<li class="chapter" data-level="5.2" data-path="opdracht-3-guerrilla-analytics-framework.html"><a href="opdracht-3-guerrilla-analytics-framework.html#b"><i class="fa fa-check"></i><b>5.2</b> B</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="opdracht-4.html"><a href="opdracht-4.html"><i class="fa fa-check"></i><b>6</b> Opdracht 4.1</a></li>
<li class="chapter" data-level="7" data-path="opdracht-4.2-deel-2.html"><a href="opdracht-4.2-deel-2.html"><i class="fa fa-check"></i><b>7</b> Opdracht 4.2: deel 2</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="massa-spectrometrie---opdracht-vrije-tijd" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Massa Spectrometrie - Opdracht vrije tijd<a href="massa-spectrometrie---opdracht-vrije-tijd.html#massa-spectrometrie---opdracht-vrije-tijd" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introductie-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introductie<a href="massa-spectrometrie---opdracht-vrije-tijd.html#introductie-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Massa spectrometrie is een technologie die ionen scheidt op basis van hun massa/lading ration (M/Z).
In deze opdracht ga ik kijken naar de massa spectrometrie data van PXD008990.
Deze studie kijkt naar leeftijdsgerelateerde glycomische en proteomische veranderingen in het nigrostriatal pathway van het brein. Bij Parkinson’s disease (PD) is er sprake van een progressieve degeneratie van dopaminerge neuronen in de nigrostriatal pathway. Gen therapie heeft potentie om deze degeneratie te vertragen of stoppen, adeno-associated virussen (AAV) zijn een voorbeeld van gen therapie. AAV receptoren zijn glycanen, in deze studie wordt er gefocussed op de receptor voor rAAV2 (heparansulfaat proteoglycaan), rAAV9 (N-glycanen met terminale galactose) en proteomics voor receptoren en co-receptoren van adeno-geassocieerd virus in het nigro-striatale gebied van de hersenen.</p>
</div>
<div id="planning" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Planning<a href="massa-spectrometrie---opdracht-vrije-tijd.html#planning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<colgroup>
<col width="2%" />
<col width="26%" />
<col width="65%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Datum</th>
<th align="left">Wat te doen</th>
<th align="left">Handelingen uitgevoerd</th>
<th align="left">Uren besteed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">19-11</td>
<td align="left">Massa spectrometrie dataset vinden en in R loaden</td>
<td align="left">Bestand 2017-02-24-RR-SRT-Rat-25.mzML gedownload, introductie geschreven, packages gedownload</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">21-11</td>
<td align="left">Verder met Ruwe Data hoofdstuk van R for Massaspectrometry</td>
<td align="left">Spectra verkregen van bestand 2017-02-24-RR-SRT en Spectra opties/functies doorgenomen, backend functies doorgenomen en visualisatie van de data</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">27-11</td>
<td align="left">Identification data hoofdstuk van R for Massaspectrometry</td>
<td align="left"></td>
<td align="left">1,5</td>
</tr>
<tr class="even">
<td align="left">1-12</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">4-12</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">10-12</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">11-12</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">16-12</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">17-12</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="uitvoering-met-voorbeeld-data" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Uitvoering met voorbeeld data<a href="massa-spectrometrie---opdracht-vrije-tijd.html#uitvoering-met-voorbeeld-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Inlezen van de data in R en downloaden van de benodigde packages</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb2-1" tabindex="-1"></a><span class="co">#Inlezen van PXD008990 in R</span></span>
<span id="cb2-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb2-2" tabindex="-1"></a>px_vb <span class="ot">&lt;-</span> <span class="fu">PXDataset</span>(<span class="st">&quot;PXD000001&quot;</span>)</span>
<span id="cb2-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb2-4" tabindex="-1"></a><span class="co">#Metadata bekijken van PXD008990</span></span>
<span id="cb2-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb2-5" tabindex="-1"></a><span class="fu">pxtax</span>(px_vb) <span class="co">#Taxonomie van het dier </span></span></code></pre></div>
<pre><code>## [1] &quot;Erwinia carotovora&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb4-1" tabindex="-1"></a><span class="fu">pxurl</span>(px_vb) <span class="co">#Website (url) waar de data vandaan komt</span></span></code></pre></div>
<pre><code>## [1] &quot;ftp://ftp.pride.ebi.ac.uk/pride/data/archive/2012/03/PXD000001/generated&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb6-1" tabindex="-1"></a><span class="fu">pxref</span>(px_vb) <span class="co">#Referentie naar het artikel</span></span></code></pre></div>
<pre><code>## [1] &quot;Gatto L, Christoforou A; Using R and Bioconductor for proteomics data analysis., Biochim Biophys Acta, 2013 May 18, doi:10.1016/j.bbapap.2013.04.032 PMID:23692960&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb8-1" tabindex="-1"></a><span class="co">#Downloaden van bestand 2017-02-24-RR-SRT-Rat-25.mzM naar R met de pxget functie</span></span>
<span id="cb8-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb8-2" tabindex="-1"></a>fn_vb <span class="ot">&lt;-</span> <span class="st">&quot;TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML&quot;</span></span>
<span id="cb8-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb8-3" tabindex="-1"></a>mzf <span class="ot">&lt;-</span> <span class="fu">pxget</span>(px_vb, fn_vb)</span></code></pre></div>
<p><strong>Ruwe data visualisatie, verwerking en manipulatie</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-1" tabindex="-1"></a>sp_vb <span class="ot">&lt;-</span> <span class="fu">Spectra</span>(mzf)</span>
<span id="cb9-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-3" tabindex="-1"></a><span class="co">#Weergeef alle metadata variabelen </span></span>
<span id="cb9-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-4" tabindex="-1"></a><span class="fu">spectraVariables</span>(sp_vb)</span>
<span id="cb9-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-5" tabindex="-1"></a><span class="co">#Extract alle metadata</span></span>
<span id="cb9-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-6" tabindex="-1"></a><span class="fu">spectraData</span>(sp_vb)</span>
<span id="cb9-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-7" tabindex="-1"></a><span class="co">#Extract een lijst met de ruwe data</span></span>
<span id="cb9-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-8" tabindex="-1"></a><span class="fu">peaksData</span>(sp_vb)</span>
<span id="cb9-9"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-9" tabindex="-1"></a><span class="co">#Check het aantal spectra in het spectra object -&gt; dit is 7534 scans</span></span>
<span id="cb9-10"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-10" tabindex="-1"></a><span class="fu">length</span>(sp_vb)</span>
<span id="cb9-11"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-12" tabindex="-1"></a><span class="co">#Maak een nieuw kolom aan met de retentie tijden in minuten</span></span>
<span id="cb9-13"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb9-13" tabindex="-1"></a>sp_vb<span class="sc">$</span>rtime_minute <span class="ot">&lt;-</span> <span class="fu">rtime</span>(sp_vb) <span class="sc">/</span> <span class="dv">60</span> </span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb10-1" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">spectraData</span>(<span class="fu">filterMsLevel</span>(sp_vb, <span class="dv">1</span>)),</span>
<span id="cb10-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb10-2" tabindex="-1"></a>     <span class="fu">plot</span>(rtime, totIonCurrent, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>))</span>
<span id="cb10-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb10-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">rtime</span>(sp_vb)[<span class="dv">2807</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/visualisatie%20chromatogram%20vb-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-1" tabindex="-1"></a><span class="co">#Verkrijg een parent set (MS1) en children (MS2) scans</span></span>
<span id="cb11-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-2" tabindex="-1"></a>ms_2_vb <span class="ot">&lt;-</span> <span class="fu">filterPrecursorScan</span>(sp_vb, <span class="dv">2807</span>)</span>
<span id="cb11-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-4" tabindex="-1"></a><span class="co">#Plot het 2807 spectrum en highlight alle pieken die voor MS2 analyse geselecteerd zijn</span></span>
<span id="cb11-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-5" tabindex="-1"></a><span class="fu">plotSpectra</span>(sp_vb[<span class="dv">2807</span>], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">1000</span>))</span>
<span id="cb11-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">precursorMz</span>(ms_2_vb)[<span class="sc">-</span><span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb11-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb11-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">precursorMz</span>(ms_2_vb)[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/visualisatie%20MS1%20en%20MS2%20vb-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb12-1" tabindex="-1"></a><span class="co">#Zoom in op mz values 521.1 en 522.5 om de isotope envelop van de pieken te weergeven</span></span>
<span id="cb12-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb12-2" tabindex="-1"></a><span class="fu">plotSpectra</span>(sp_vb[<span class="dv">2807</span>], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">521.2</span>, <span class="fl">522.5</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb12-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb12-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">precursorMz</span>(ms_2_vb)[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/visualisatie%20MS1%20en%20MS2%20vb-2.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb13-1" tabindex="-1"></a><span class="co">#Plot alle 10 de MS2 spectra</span></span>
<span id="cb13-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb13-2" tabindex="-1"></a><span class="fu">plotSpectra</span>(ms_2_vb[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/visualisatie%20MS2%20vb-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb14-1" tabindex="-1"></a>sp2_vb <span class="ot">&lt;-</span> <span class="fu">filterMsLevel</span>(sp_vb, <span class="dv">2</span><span class="dt">L</span>)</span>
<span id="cb14-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb14-2" tabindex="-1"></a><span class="fu">anyDuplicated</span>(<span class="fu">precursorMz</span>(<span class="fu">filterMsLevel</span>(sp_vb, <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 37</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb16-1" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">precursorMz</span>(sp2_vb) <span class="sc">==</span> <span class="fu">precursorMz</span>(sp2_vb)[<span class="dv">37</span>])</span>
<span id="cb16-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb16-2" tabindex="-1"></a>sp2_vbi <span class="ot">&lt;-</span> sp2_vb[i]</span>
<span id="cb16-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb16-4" tabindex="-1"></a><span class="co">#Visualiseer het matchende paar</span></span>
<span id="cb16-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb16-5" tabindex="-1"></a><span class="fu">plotSpectraOverlay</span>(sp2_vbi, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;steelblue&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/Comparing%20spectra-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb17-1" tabindex="-1"></a><span class="fu">plotSpectraMirror</span>(sp2_vbi[<span class="dv">1</span>], sp2_vbi[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/Comparing%20spectra-2.png" width="672" /></p>
<p><strong>Identification data</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb18-1" tabindex="-1"></a>idf <span class="ot">&lt;-</span> msdata<span class="sc">::</span><span class="fu">ident</span>(<span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb18-2" tabindex="-1"></a><span class="fu">basename</span>(idf)</span></code></pre></div>
<pre><code>## [1] &quot;TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzid&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb20-1" tabindex="-1"></a><span class="co">#Inlezen van de mzIdentML (mzid)</span></span>
<span id="cb20-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb20-2" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">PSM</span>(idf)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb21-1" tabindex="-1"></a><span class="co">#Het onderstaande tabel geeft het aantal spectra aan die 1, 2, 3, 4 of 5 matches hebben. </span></span>
<span id="cb21-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb21-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">table</span>(id<span class="sc">$</span>spectrumID))</span></code></pre></div>
<pre><code>## 
##    1    2    3    4    5 
## 4936  369   26   10    2</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb23-1" tabindex="-1"></a><span class="co">#Om te zien hoeveel matches scan 1774 heeft:</span></span>
<span id="cb23-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb23-2" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">which</span>(id<span class="sc">$</span>spectrumID <span class="sc">==</span> <span class="st">&quot;controllerType=0 controllerNumber=1 scan=1774&quot;</span>)</span>
<span id="cb23-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb23-3" tabindex="-1"></a><span class="fu">data.frame</span>(id[i, ])[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##    sequence                                    spectrumID chargeState rank
## 1 RTRYQAEVR controllerType=0 controllerNumber=1 scan=1774           2    1
## 2 RTRYQAEVR controllerType=0 controllerNumber=1 scan=1774           2    1
## 3 RTRYQAEVR controllerType=0 controllerNumber=1 scan=1774           2    1
## 4 RTRYQAEVR controllerType=0 controllerNumber=1 scan=1774           2    1
##   passThreshold
## 1          TRUE
## 2          TRUE
## 3          TRUE
## 4          TRUE</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb25-1" tabindex="-1"></a><span class="co">#Reducing het PSM object met variabele sprectrumID</span></span>
<span id="cb25-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb25-2" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> <span class="fu">reducePSMs</span>(id, id<span class="sc">$</span>spectrumID)</span>
<span id="cb25-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb25-4" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">which</span>(id2<span class="sc">$</span>spectrumID <span class="sc">==</span> <span class="st">&quot;controllerType=0 controllerNumber=1 scan=1774&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-1" tabindex="-1"></a><span class="co">#Zet de dataframe om naar een tibble</span></span>
<span id="cb26-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-2" tabindex="-1"></a>id_tbl <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">as_tibble</span>(id)</span>
<span id="cb26-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-4" tabindex="-1"></a><span class="co">#Verwijder decoy hits</span></span>
<span id="cb26-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-5" tabindex="-1"></a>id_tbl <span class="ot">&lt;-</span> id_tbl <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-6" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>isDecoy)</span>
<span id="cb26-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-8" tabindex="-1"></a><span class="co">#Houd de first rank matches</span></span>
<span id="cb26-9"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-9" tabindex="-1"></a>id_tbl <span class="ot">&lt;-</span> id_tbl <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-10" tabindex="-1"></a>    <span class="fu">filter</span>(rank <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb26-11"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-12" tabindex="-1"></a><span class="co">#Verwijder de gedeelde peptides</span></span>
<span id="cb26-13"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-13" tabindex="-1"></a>mltm <span class="ot">&lt;-</span></span>
<span id="cb26-14"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-14" tabindex="-1"></a>    id_tbl <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-15" tabindex="-1"></a>    <span class="fu">group_by</span>(spectrumID) <span class="sc">%&gt;%</span></span>
<span id="cb26-16"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">nProts =</span> <span class="fu">length</span>(<span class="fu">unique</span>(DatabaseAccess))) <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-17" tabindex="-1"></a>    <span class="fu">filter</span>(nProts <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-18"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-18" tabindex="-1"></a>    <span class="fu">select</span>(spectrumID, nProts)</span>
<span id="cb26-19"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-19" tabindex="-1"></a>id_tbl <span class="ot">&lt;-</span></span>
<span id="cb26-20"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-20" tabindex="-1"></a>    id_tbl <span class="sc">%&gt;%</span></span>
<span id="cb26-21"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-21" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>spectrumID <span class="sc">%in%</span> mltm<span class="sc">$</span>spectrumID)</span>
<span id="cb26-22"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-22" tabindex="-1"></a></span>
<span id="cb26-23"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-23" tabindex="-1"></a><span class="co">#Je kan ook je data filteren met filterPMS(), beide geven een output van 2666 PSMs</span></span>
<span id="cb26-24"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-24" tabindex="-1"></a>id_filtered <span class="ot">&lt;-</span> <span class="fu">filterPSMs</span>(id)</span>
<span id="cb26-25"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-25" tabindex="-1"></a></span>
<span id="cb26-26"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-26" tabindex="-1"></a><span class="co">#describePeptides geeft het aantal unieke of gedeelde peptides</span></span>
<span id="cb26-27"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-27" tabindex="-1"></a><span class="fu">describePeptides</span>(id_filtered) <span class="co">#Zou alleen unieke hits moeten geven aangezien de gedeelde eruit zijn gefilterd</span></span>
<span id="cb26-28"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-28" tabindex="-1"></a></span>
<span id="cb26-29"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-29" tabindex="-1"></a><span class="co">#describeProteins geeft het aantal eiwitten/proteins gedefinieerd door alleen unieke, alleen gedeelde of een mix van beide.</span></span>
<span id="cb26-30"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-30" tabindex="-1"></a><span class="fu">describeProteins</span>(id_filtered)</span>
<span id="cb26-31"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-31" tabindex="-1"></a></span>
<span id="cb26-32"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-32" tabindex="-1"></a><span class="co">#Vergelijk de distributie van ruwe identificatie scores van de decoy en de niet-decoy hits</span></span>
<span id="cb26-33"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-33" tabindex="-1"></a><span class="fu">as_tibble</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb26-34"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-34" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MS.GF.RawScore,</span>
<span id="cb26-35"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-35" tabindex="-1"></a>               <span class="at">colour =</span> isDecoy)) <span class="sc">+</span></span>
<span id="cb26-36"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb26-36" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/filtering%20data-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-1" tabindex="-1"></a><span class="co">#Bereken de lengte van elke peptide en het aantal peptides per eiwit en plot de lengte van de peptide tegen hun respectieve aantal peptides</span></span>
<span id="cb27-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-2" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>))</span>
<span id="cb27-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-3" tabindex="-1"></a>iddf <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(id_filtered) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">peplen =</span> <span class="fu">nchar</span>(sequence))</span>
<span id="cb27-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-5" tabindex="-1"></a>npeps <span class="ot">&lt;-</span> iddf <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-6" tabindex="-1"></a>    <span class="fu">group_by</span>(DatabaseAccess) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-7" tabindex="-1"></a>    tally</span>
<span id="cb27-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-8" tabindex="-1"></a>iddf <span class="ot">&lt;-</span> <span class="fu">full_join</span>(iddf, npeps)</span>
<span id="cb27-9"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-9" tabindex="-1"></a><span class="do">## Joining with `by = join_by(DatabaseAccess)`</span></span>
<span id="cb27-10"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-10" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb27-11"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb27-11" tabindex="-1"></a><span class="fu">ggplot</span>(iddf, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> DBseqLength)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/filtering%20data-2.png" width="672" /></p>
<p><em>Combineren van identification data met de ruw data</em></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb28-1" tabindex="-1"></a><span class="co">#Spectra met meerdere PSMs</span></span>
<span id="cb28-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb28-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">table</span>(id_filtered<span class="sc">$</span>spectrumID))</span></code></pre></div>
<pre><code>## 
##    1    2    3    4 
## 2630   13    2    1</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb30-1" tabindex="-1"></a><span class="co">#Zoeken welk spectrum 4 matching PSMs heeft</span></span>
<span id="cb30-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb30-2" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">table</span>(id_filtered<span class="sc">$</span>spectrumID) <span class="sc">==</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## controllerType=0 controllerNumber=1 scan=5490 
##                                          1903</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb32-1" tabindex="-1"></a><span class="co">#Filter dit spectrum uit de data en maak een dataframe ervan</span></span>
<span id="cb32-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb32-2" tabindex="-1"></a>id_4 <span class="ot">&lt;-</span> id_filtered[id_filtered<span class="sc">$</span>spectrumID <span class="sc">==</span> <span class="st">&quot;controllerType=0 controllerNumber=1 scan=5490&quot;</span>, ] <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb32-3" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb32-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb32-5" tabindex="-1"></a><span class="co">#De vier PSM verschillen in locatie van de Carbamidomethyl modificatie, dit kan je zien in de dataframe of selecteren met:</span></span>
<span id="cb32-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb32-6" tabindex="-1"></a>id_4[, <span class="fu">c</span>(<span class="st">&quot;modName&quot;</span>, <span class="st">&quot;modLocation&quot;</span>)]</span></code></pre></div>
<pre><code>##           modName modLocation
## 1 Carbamidomethyl           2
## 2 Carbamidomethyl           5
## 3 Carbamidomethyl          10
## 4 Carbamidomethyl          15</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-1" tabindex="-1"></a><span class="co">#De PMS table reduceren om alleen een-op-een matches tussen ruwe spectra en PSMs te krijgen</span></span>
<span id="cb34-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-2" tabindex="-1"></a>id_filtered <span class="ot">&lt;-</span> <span class="fu">reducePSMs</span>(id_filtered, id_filtered<span class="sc">$</span>spectrumID)</span>
<span id="cb34-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-4" tabindex="-1"></a><span class="co">#Dan kan je het spectra object en de PSM table samenvoegen</span></span>
<span id="cb34-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-5" tabindex="-1"></a>sp_vb <span class="ot">&lt;-</span> <span class="fu">joinSpectraData</span>(sp_vb, id_filtered,</span>
<span id="cb34-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-6" tabindex="-1"></a>                      <span class="at">by.x =</span> <span class="st">&quot;spectrumId&quot;</span>,</span>
<span id="cb34-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-7" tabindex="-1"></a>                      <span class="at">by.y =</span> <span class="st">&quot;spectrumID&quot;</span>)</span>
<span id="cb34-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-9" tabindex="-1"></a><span class="co">#Na gaan of er geen identificatie data is toegevoegd aan de MS1 scans</span></span>
<span id="cb34-10"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb34-10" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">is.na</span>(<span class="fu">filterMsLevel</span>(sp_vb, <span class="dv">1</span>)<span class="sc">$</span>sequence))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb36-1" tabindex="-1"></a><span class="co">#Na gaan of het wel is toegevoegd aan de MS2 scans</span></span>
<span id="cb36-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb36-2" tabindex="-1"></a>sp2_vb <span class="ot">&lt;-</span> <span class="fu">filterMsLevel</span>(sp_vb, <span class="dv">2</span>)</span>
<span id="cb36-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb36-3" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(sp2_vb<span class="sc">$</span>sequence))</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##  2646  3457</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb38-1" tabindex="-1"></a><span class="co">#Vergelijk de precursor/ peptide mass to charges</span></span>
<span id="cb38-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb38-2" tabindex="-1"></a>sp2_vb <span class="ot">&lt;-</span> sp2_vb[<span class="sc">!</span><span class="fu">is.na</span>(sp2_vb<span class="sc">$</span>sequence)]</span>
<span id="cb38-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb38-3" tabindex="-1"></a><span class="fu">summary</span>(sp2_vb<span class="sc">$</span>precursorMz <span class="sc">-</span> sp2_vb<span class="sc">$</span>experimentalMassToCharge)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  0.0053  0.0000  2.0297</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb40-1" tabindex="-1"></a><span class="co">#Tel het aantal identificaties voor elke scan</span></span>
<span id="cb40-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb40-2" tabindex="-1"></a>sp_vb <span class="ot">&lt;-</span> <span class="fu">countIdentifications</span>(sp_vb)</span>
<span id="cb40-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb40-4" tabindex="-1"></a><span class="co">#Toon het aantal PSMs per scan. </span></span>
<span id="cb40-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb40-5" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">msLevel</span>(sp_vb), sp_vb<span class="sc">$</span>countIdentifications)</span></code></pre></div>
<pre><code>##    
##        0    1    2    3    4    5    6    7    8    9   10
##   1  833   30   45   97  139  132   92   42   17    3    1
##   2 3457 2646    0    0    0    0    0    0    0    0    0</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-1" tabindex="-1"></a><span class="co">#Visualisatie van de data in de total ion chromatogram</span></span>
<span id="cb42-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-2" tabindex="-1"></a>sp_vb <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-3" tabindex="-1"></a><span class="fu">filterMsLevel</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-4" tabindex="-1"></a><span class="fu">spectraData</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-5" tabindex="-1"></a><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rtime,</span>
<span id="cb42-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-7" tabindex="-1"></a>           <span class="at">y =</span> totIonCurrent)) <span class="sc">+</span></span>
<span id="cb42-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-8" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-9" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">ifelse</span>(countIdentifications <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb42-10"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-10" tabindex="-1"></a>                                   <span class="cn">NA</span>, countIdentifications)),</span>
<span id="cb42-11"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-11" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb42-12"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-12" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-13"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb42-13" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;Number of ids&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/total%20ion%20chromatogram-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb43-1" tabindex="-1"></a><span class="co">#Kies een MS2 Spectrum met een hoge identificatie score en plot het</span></span>
<span id="cb43-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb43-2" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">which</span>(sp_vb<span class="sc">$</span>MS.GF.RawScore <span class="sc">&gt;</span> <span class="dv">100</span>)[<span class="dv">1</span>]</span>
<span id="cb43-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb43-3" tabindex="-1"></a><span class="fu">plotSpectra</span>(sp_vb[i])</span></code></pre></div>
<p><img src="_main_files/figure-html/peptide-spectrum%20matches-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb44-1" tabindex="-1"></a><span class="co">#Gebruik de addFragments() functie om de pieken te annoteren</span></span>
<span id="cb44-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb44-2" tabindex="-1"></a><span class="fu">plotSpectra</span>(sp_vb[i], <span class="at">labels =</span> addFragments,</span>
<span id="cb44-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb44-3" tabindex="-1"></a>            <span class="at">labelPos =</span> <span class="dv">3</span>, <span class="at">labelCol =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/peptide-spectrum%20matches-2.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb45-1" tabindex="-1"></a><span class="co">#Matching observed peaks to fragments</span></span>
<span id="cb45-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb45-2" tabindex="-1"></a>sp_vb[i]<span class="sc">$</span>sequence</span></code></pre></div>
<pre><code>## [1] &quot;THSQEEMQHMQR&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb47-1" tabindex="-1"></a><span class="fu">calculateFragments</span>(sp_vb[i]<span class="sc">$</span>sequence)</span></code></pre></div>
<pre><code>## Modifications used: C=57.02146</code></pre>
<pre><code>##           mz  ion type pos z         seq
## 1   102.0550   b1    b   1 1           T
## 2   239.1139   b2    b   2 1          TH
## 3   326.1459   b3    b   3 1         THS
## 4   454.2045   b4    b   4 1        THSQ
## 5   583.2471   b5    b   5 1       THSQE
## 6   712.2897   b6    b   6 1      THSQEE
## 7   843.3301   b7    b   7 1     THSQEEM
## 8   971.3887   b8    b   8 1    THSQEEMQ
## 9  1108.4476   b9    b   9 1   THSQEEMQH
## 10 1239.4881  b10    b  10 1  THSQEEMQHM
## 11 1367.5467  b11    b  11 1 THSQEEMQHMQ
## 12  175.1190   y1    y   1 1           R
## 13  303.1775   y2    y   2 1          QR
## 14  434.2180   y3    y   3 1         MQR
## 15  571.2769   y4    y   4 1        HMQR
## 16  699.3355   y5    y   5 1       QHMQR
## 17  830.3760   y6    y   6 1      MQHMQR
## 18  959.4186   y7    y   7 1     EMQHMQR
## 19 1088.4612   y8    y   8 1    EEMQHMQR
## 20 1216.5198   y9    y   9 1   QEEMQHMQR
## 21 1303.5518  y10    y  10 1  SQEEMQHMQR
## 22 1440.6107  y11    y  11 1 HSQEEMQHMQR
## 23  436.1939  b4_   b_   4 1        THSQ
## 24  565.2365  b5_   b_   5 1       THSQE
## 25  694.2791  b6_   b_   6 1      THSQEE
## 26  825.3196  b7_   b_   7 1     THSQEEM
## 27  953.3782  b8_   b_   8 1    THSQEEMQ
## 28 1090.4371  b9_   b_   9 1   THSQEEMQH
## 29 1221.4776 b10_   b_  10 1  THSQEEMQHM
## 30 1349.5361 b11_   b_  11 1 THSQEEMQHMQ
## 31  941.4080  y7_   y_   7 1     EMQHMQR
## 32 1070.4506  y8_   y_   8 1    EEMQHMQR
## 33 1422.6001 y11_   y_  11 1 HSQEEMQHMQR
## 34  157.1084  y1_   y_   1 1           R
## 35  285.1670  y2_   y_   2 1          QR
## 36  416.2075  y3_   y_   3 1         MQR
## 37  553.2664  y4_   y_   4 1        HMQR
## 38  681.3249  y5_   y_   5 1       QHMQR
## 39  812.3654  y6_   y_   6 1      MQHMQR
## 40 1198.5092  y9_   y_   9 1   QEEMQHMQR
## 41 1285.5412 y10_   y_  10 1  SQEEMQHMQR
## 42  566.2205  b5*   b*   5 1       THSQE
## 43  695.2631  b6*   b*   6 1      THSQEE
## 44  826.3036  b7*   b*   7 1     THSQEEM
## 45  954.3622  b8*   b*   8 1    THSQEEMQ
## 46 1091.4211  b9*   b*   9 1   THSQEEMQH
## 47 1222.4616 b10*   b*  10 1  THSQEEMQHM
## 48 1350.5202 b11*   b*  11 1 THSQEEMQHMQ
## 49  286.1510  y2*   y*   2 1          QR
## 50  417.1915  y3*   y*   3 1         MQR
## 51  554.2504  y4*   y*   4 1        HMQR
## 52  682.3090  y5*   y*   5 1       QHMQR
## 53  813.3495  y6*   y*   6 1      MQHMQR
## 54  942.3920  y7*   y*   7 1     EMQHMQR
## 55 1071.4346  y8*   y*   8 1    EEMQHMQR
## 56 1199.4932  y9*   y*   9 1   QEEMQHMQR
## 57 1286.5252 y10*   y*  10 1  SQEEMQHMQR
## 58 1423.5842 y11*   y*  11 1 HSQEEMQHMQR</code></pre>
<p><strong>Comparing Spectra</strong></p>
</div>
<div id="uitvoering-met-eigen-data" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Uitvoering met eigen data<a href="massa-spectrometrie---opdracht-vrije-tijd.html#uitvoering-met-eigen-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Inlezen van de data in R</strong></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-1" tabindex="-1"></a><span class="co">#Inlezen van PXD008990 in R</span></span>
<span id="cb50-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-2" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">PXDataset</span>(<span class="st">&quot;PXD008990&quot;</span>)</span>
<span id="cb50-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-3" tabindex="-1"></a></span>
<span id="cb50-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-4" tabindex="-1"></a><span class="co">#Bekijken van alle bestanden die horen bij PXD008990</span></span>
<span id="cb50-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-5" tabindex="-1"></a><span class="fu">pxfiles</span>(px)</span>
<span id="cb50-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-6" tabindex="-1"></a></span>
<span id="cb50-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-7" tabindex="-1"></a><span class="co">#Metadata bekijken van PXD008990</span></span>
<span id="cb50-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb50-8" tabindex="-1"></a><span class="fu">pxtax</span>(px) <span class="co">#Taxonomie van het dier </span></span></code></pre></div>
<pre><code>## [1] &quot;Rattus norvegicus (rat)&quot;</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb52-1" tabindex="-1"></a><span class="fu">pxurl</span>(px) <span class="co">#Website (url) waar de data vandaan komt</span></span></code></pre></div>
<pre><code>## [1] &quot;ftp://ftp.pride.ebi.ac.uk/pride/data/archive/2018/06/PXD008990&quot;</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb54-1" tabindex="-1"></a><span class="fu">pxref</span>(px) <span class="co">#Referentie naar het artikel</span></span></code></pre></div>
<pre><code>## [1] &quot;Raghunathan R, Polinski NK, Klein JA, Hogan JD, Shao C, Khatri K, Leon D, McComb ME, Manfredsson FP, Sortwell CE, Zaia J. Glycomic and Proteomic Changes in Aging Brain Nigrostriatal Pathway. Mol Cell Proteomics. 2018 17(9):1778-1787 doi:10.1074/mcp.ra118.000680 PMID:29915149&quot;</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb56-1" tabindex="-1"></a><span class="co">#Downloaden van bestand 2017-02-24-RR-SRT-Rat-25.mzM naar R met de pxget functie</span></span>
<span id="cb56-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb56-2" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;2017-02-24-RR-SRT-Rat-25.mzML&quot;</span></span>
<span id="cb56-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb56-3" tabindex="-1"></a>Rat_25.mzML <span class="ot">&lt;-</span> <span class="fu">pxget</span>(px, filename)</span></code></pre></div>
<p><strong>Ruwe data visualisatie, verwerking en manipulatie</strong></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-1" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">Spectra</span>(Rat_25.mzML)</span>
<span id="cb57-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-3" tabindex="-1"></a><span class="co">#Weergeef alle metadata variabelen </span></span>
<span id="cb57-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-4" tabindex="-1"></a><span class="fu">spectraVariables</span>(spectra)</span>
<span id="cb57-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-5" tabindex="-1"></a><span class="co">#Extract alle metadata</span></span>
<span id="cb57-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-6" tabindex="-1"></a><span class="fu">spectraData</span>(spectra)</span>
<span id="cb57-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-7" tabindex="-1"></a><span class="co">#Extract een lijst met de ruwe data</span></span>
<span id="cb57-8"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-8" tabindex="-1"></a><span class="fu">peaksData</span>(spectra)</span>
<span id="cb57-9"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-9" tabindex="-1"></a><span class="co">#Check het aantal spectra in het spectra object -&gt; dit is 37016 scans</span></span>
<span id="cb57-10"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-10" tabindex="-1"></a><span class="fu">length</span>(spectra)</span>
<span id="cb57-11"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-11" tabindex="-1"></a></span>
<span id="cb57-12"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-12" tabindex="-1"></a><span class="co">#Maak een nieuw kolom aan met de retentie tijden in minuten</span></span>
<span id="cb57-13"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-13" tabindex="-1"></a>spectra<span class="sc">$</span>rtime_minute <span class="ot">&lt;-</span> <span class="fu">rtime</span>(spectra) <span class="sc">/</span> <span class="dv">60</span> </span>
<span id="cb57-14"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb57-14" tabindex="-1"></a>spectra<span class="sc">$</span>rtime_minute <span class="sc">%&gt;%</span> <span class="fu">head</span>() </span></code></pre></div>
<p><em>Backends</em> <br>
Backends maken het mogelijk om verschillende backends te gebruiken om massa spectrometrie data in op te slaan, terwijl het via de Spectra-klasse een uniform interface biedt om die gegevens te gebruiken. <br>
Verschillende backends: <br>
- MsBackendMzR: deze backend bewaard alleen algemene spectra variabelen en berust op het mzR pakket om massa peaks van de orginele MS-bestanden te lezen. <br>
- MsBackendMemory &amp; MsBackendDataFrame: de volledige MS data is opgeslagen in het geheugen van het object. <br>
- MsBackendHdf5Peaks: leest alleen peakgegevens op aanvraag, terwijl alle andere spectra variabelen in geheugen worden bewaard. De piekgegevens worden opgeslagen in Hdf5-bestanden. <br>
- MsBackendSql: alle data opslaan in een SQL database. <br></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb58-1" tabindex="-1"></a><span class="co">#Ga als je tijd over hebt het Spectra pakket doornemen om meer info te krijgen over o.a. backends</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb59-1" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">spectraData</span>(<span class="fu">filterMsLevel</span>(spectra, <span class="dv">1</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb59-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb59-2" tabindex="-1"></a>    <span class="fu">plot</span>(spectra<span class="sc">$</span>rtime, spectra<span class="sc">$</span>totIonCurrent, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)) <span class="co">#Lengths differ, but why? Length() gives the same length for both, any(is.na()) gives FALSE for both so no NA&#39;s. length(spectra$totIonCurrent) == length(spectra$rtime) geeft TRUE. Wel verschil in length(unique) :length(unique(spectra$rtime)) = 37016, length(unique(spectra$totIonCurrent)) = 37007</span></span>
<span id="cb59-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb59-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">rtime</span>(spectra)[<span class="dv">3000</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-1" tabindex="-1"></a><span class="co">#Verkrijg een set parent (MS1) en children (MS2) scans</span></span>
<span id="cb60-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-2" tabindex="-1"></a>ms_2 <span class="ot">&lt;-</span> <span class="fu">filterPrecursorScan</span>(spectra, <span class="dv">15000</span>)</span>
<span id="cb60-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-3" tabindex="-1"></a></span>
<span id="cb60-4"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-4" tabindex="-1"></a><span class="co">#Plot het MS spectrum van scan 3000 en highlight alle pieken die voor MS2 analyse geselecteerd worden</span></span>
<span id="cb60-5"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-5" tabindex="-1"></a><span class="fu">plotSpectra</span>(spectra[<span class="dv">15000</span>], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">1000</span>))</span>
<span id="cb60-6"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">precursorMz</span>(ms_2)[<span class="sc">-</span><span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb60-7"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb60-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">precursorMz</span>(ms_2)[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/visualitatie%20MS1%20en%20MS2-1.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb61-1" tabindex="-1"></a><span class="co">#Zoom in op mz values ... en ... om de isotope envelop van de pieken te weergeven</span></span>
<span id="cb61-2"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb61-2" tabindex="-1"></a><span class="co">#plotSpectra(spectra[15000], xlim = c(..., ...), type = &quot;l&quot;)</span></span>
<span id="cb61-3"><a href="massa-spectrometrie---opdracht-vrije-tijd.html#cb61-3" tabindex="-1"></a><span class="co">#abline(v = precursorMz(ms_2)[2], col = &quot;red&quot;)</span></span></code></pre></div>
<p><strong>Identification data</strong></p>
</div>
<div id="metadata" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Metadata<a href="massa-spectrometrie---opdracht-vrije-tijd.html#metadata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Objecten</em> <br>
px: bevat de bestanden van PXD008990, deze zijn verkregen met de pxDataset functie van het rpx pakket</p>
<p><em>Values</em> <br>
filename: de bestandsnaam van het bestand dat gedownload moet worden voor analyse, in dit geval wordt 2017-02-24-RR-SRT-Rat_25.mzML gebruikt. <br>
Rat_25.mzML: ????????</p>
</div>
<div id="links" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Links<a href="massa-spectrometrie---opdracht-vrije-tijd.html#links" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Massa spectrometry website voor R: <a href="https://www.rformassspectrometry.org/pkgs/" class="uri">https://www.rformassspectrometry.org/pkgs/</a> <br>
PRIDE databank: <a href="https://www.ebi.ac.uk/pride/archive/projects/PXD008990" class="uri">https://www.ebi.ac.uk/pride/archive/projects/PXD008990</a> <br>
Pubmed artikel “Glycomic and Proteomic Changes in Aging Brain Nigrostriatal Pathway”: <a href="https://pubmed.ncbi.nlm.nih.gov/29915149/" class="uri">https://pubmed.ncbi.nlm.nih.gov/29915149/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="opdracht-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="opdracht-3-guerrilla-analytics-framework.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
